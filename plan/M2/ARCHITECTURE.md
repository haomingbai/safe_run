# M2 架构设计

## 1. 关键增强点

- 在 `sr-policy` 内新增 `PathSecurityEngine`。
- 在 `sr-compiler` 内新增 `MountPlanBuilder`。
- 在 `sr-runner` 内新增 `MountExecutor` 与回滚器。

## 2. 执行流程差异（相对 M1）

1. 策略校验阶段新增路径规范化和白名单匹配。
2. 编译阶段输出可执行挂载计划（含顺序与回滚点）。
3. 执行阶段先做挂载，再启动 VM；失败时按逆序回滚。
4. 证据阶段记录“请求-决策-应用-结果”全过程。

## 3. 安全策略

- deny-by-default：无显式允许则拒绝挂载。
- 组合约束：读写挂载数量、路径级别与资源等级联合判定。
- 防逃逸：拒绝软链跳转到非白名单路径。

## 4. 可测试性

- 构造恶意样例库（路径穿越、软链绕过、边界条件）。
- 对挂载计划做快照测试，确保策略变更可感知。
